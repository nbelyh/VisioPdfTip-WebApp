import{j as e,D as g}from"./DropZone.9cd9475e.js";import{r as i}from"./index.ed373d49.js";const v=x=>{const[s,c]=i.useState(),[o,n]=i.useState(""),[d,l]=i.useState(!1),m=a=>{c(a)},p=()=>{if(s){var a=new FormData;a.append("vsdx",s),l(!0),n(""),fetch("https://visiopdftip.azurewebsites.net/api/ExtractImagesAzureFunction",{method:"POST",body:a}).then(t=>t.blob()).then(t=>{var h=window.URL.createObjectURL(t),r=document.createElement("a");r.target="_blank",r.href=h,r.download=`${s.name.replace(/\.[^/.]+$/,"")}_images.zip`,r.click()}).catch(t=>{n(t.message)}).finally(()=>{l(!1)})}else n("Please select the VSDX file")};return e.jsxs(e.Fragment,{children:[!!o&&e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-10 alert alert-danger mt-3",children:[e.jsx("strong",{children:"Ups! Something went wrong"}),". Please make sure you have selected the VSDX (not VSD) file, or reload the page and try again: ",o,". If it the problem persists, please report an issue to our",e.jsx("a",{href:"https://github.com/nbelyh/visiopdftip-webapp/issues",target:"_blank",children:"GitHub"})]})}),e.jsx("div",{className:"row",children:e.jsx(g,{accept:"application/vnd.ms-visio.drawing",sampleFileName:"ImageSample.vsdx",label:"Drop the Visio VSDX file to extract media (images) from here",onChange:m})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-md-10",style:{textAlign:"center"},children:s&&e.jsx("button",{className:"btn btn-primary",disabled:d,onClick:p,children:"Extract Images"})})})]})};export{v as ExtractImages};
